#### Set(集合)

- Redis的Set是string类型的**无序集合**。**集合成员是唯一的**，这就意味着集合中**不能出现重复**的数据。
- Redis 中 集合是**通过哈希表实现**的，所以添加，删除，查找的复杂度都是O(1)。

- 集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。

|                    命令                     |                             描述                             |           追加描述           |
| :-----------------------------------------: | :----------------------------------------------------------: | :--------------------------: |
|      **SAdd key member1 [member2..]**       |              向集合中无序**增加**一个/多个成员               |                              |
|                **SCard key**                |                     获取集合的**成员数**                     |                              |
|              **SMembers key**               |                   返回集合中**所有**的成员                   |                              |
|          **SIsMember key member**           |       **查询**member元素是否是集合的成员,结果是无序的        |                              |
|         **SRandMember key [count]**         | **随机返回**集合中count个成员，count缺省值为1（count不写默认1） |                              |
|            **SPop key [count]**             |     **随机移除**并返回集合中count个成员，count缺省值为1      |                              |
|     **SMove source destination member**     |      将source集合的成员member**移动**到destination集合       |                              |
|      **SRem key member1 [member2..]**       |                 **移除**集合中一个/多个成员                  |                              |
|           **SDiff key1 [key2..]**           |          返回所有集合的**差集** （key1- key2 - …）           | 找key1中不存在于key2中的元素 |
|  **SDiffStore destination key1 [key2..]**   | 在**SDIFF**的基础上，将结果保存到集合destination中(覆盖)。不能保存到其他类型key噢！ | 找key1中不存在于key2中的元素 |
|          **SInter key1 [key2..]**           |                    返回所有集合的**交集**                    |                              |
|  **SInterStore destination key1[key2..]**   |   在**SINTER**的基础上，存储结果到集合destination中。覆盖    |                              |
|          **SUnion key1 [key2..]**           |                    返回所有集合的**并集**                    |                              |
|  **SUnionStore destination key1 [key2..]**  |   在**SUNION**的基础上，存储结果到集合destination中。覆盖    |                              |
| **SScan key [MATCH pattern] [COUNT count]** |   在大量数据环境下，使用此命令遍历集合中元素，每次遍历部分   |                              |

实例

```shell
---------------SADD--SCARD--SMEMBERS--SISMEMBER--------------------

127.0.0.1:6379> SADD myset m1 m2 m3 m4 # 向myset中增加成员 m1~m4
(integer) 4
127.0.0.1:6379> SCARD myset # 获取集合的成员数目
(integer) 4
127.0.0.1:6379> smembers myset # 获取集合中所有成员
1) "m4"
2) "m3"
3) "m2"
4) "m1"
127.0.0.1:6379> SISMEMBER myset m5 # 查询m5是否是myset的成员
(integer) 0 # 不是，返回0
127.0.0.1:6379> SISMEMBER myset m2
(integer) 1 # 是，返回1
127.0.0.1:6379> SISMEMBER myset m3
(integer) 1

---------------------SRANDMEMBER--SPOP----------------------------------

127.0.0.1:6379> SRANDMEMBER myset 3 # 随机返回3个成员
1) "m2"
2) "m3"
3) "m4"
127.0.0.1:6379> SRANDMEMBER myset # 随机返回1个成员
"m3"
127.0.0.1:6379> SPOP myset 2 # 随机移除并返回2个成员
1) "m1"
2) "m4"
# 将set还原到{m1,m2,m3,m4}

---------------------SMOVE--SREM----------------------------------------

127.0.0.1:6379> SMOVE myset newset m3 # 将myset中m3成员移动到newset集合
(integer) 1
127.0.0.1:6379> SMEMBERS myset
1) "m4"
2) "m2"
3) "m1"
127.0.0.1:6379> SMEMBERS newset
1) "m3"
127.0.0.1:6379> SREM newset m3 # 从newset中移除m3元素
(integer) 1
127.0.0.1:6379> SMEMBERS newset
(empty list or set)

# 下面开始是多集合操作,多集合操作中若只有一个参数默认和自身进行运算
# setx=>{m1,m2,m4,m6}, sety=>{m2,m5,m6}, setz=>{m1,m3,m6}

-----------------------------SDIFF------------------------------------

127.0.0.1:6379> SDIFF setx sety setz # 等价于setx-sety-setz
1) "m4"
127.0.0.1:6379> SDIFF setx sety # setx - sety
1) "m4"
2) "m1"
127.0.0.1:6379> SDIFF sety setx # sety - setx
1) "m5"


-------------------------SINTER---------------------------------------
# 共同关注（交集）

127.0.0.1:6379> SINTER setx sety setz # 求 setx、sety、setx的交集
1) "m6"
127.0.0.1:6379> SINTER setx sety # 求setx sety的交集
1) "m2"
2) "m6"

-------------------------SUNION---------------------------------------

127.0.0.1:6379> SUNION setx sety setz # setx sety setz的并集
1) "m4"
2) "m6"
3) "m3"
4) "m2"
5) "m1"
6) "m5"
127.0.0.1:6379> SUNION setx sety # setx sety 并集
1) "m4"
2) "m6"
3) "m2"
4) "m1"
5) "m5"
```

应用场景

- 微博，关注放一个集合，粉丝放一个集合
- 共同关注、共同爱好、二度好友、推荐好友！（六度分割理论）
