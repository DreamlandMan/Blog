#### Commit镜像

- docker commit：提交容器成为一个新的副本

  ```shell
  #命令和Git原理类似
  docker commit -m="描述信息" -a="作者" 容器id 目标镜像名[:TAG]
  ```

- 这里我们使用Tomcat容器做试验

  - 官方的tomcat镜像webapps目录下是没有文件的，在webapps.dist目录中，我们将webapps.dist目录中的文件拷贝到webapps目录中，打包成一个新镜像

  - 开一个新连接面板启动一个tomcat容器

  - 回到之前的连接面板，进入tomcat容器，使用目录cp -r webapps.dist/* webapps命令将webapps.dist中的文件拷贝到webapps目录中

  - 将这个tomcat容器打包成新镜像：docker commit -m="add webapps app" -a="hzc" 3da1f6ac3f10 mytomcat:1.0

  - docker images查看新镜像是否打包成功

    ```shell
    #连接面板2
    [root@iZ0jlettlgobqrxnscuoovZ ~]# docker run -it -p 8080:8080 tomcat:9.0
    Using CATALINA_BASE:   /usr/local/tomcat
    Using CATALINA_HOME:   /usr/local/tomcat
    Using CATALINA_TMPDIR: /usr/local/tomcat/temp
    Using JRE_HOME:        /usr/local/openjdk-11
    Using CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar
    Using CATALINA_OPTS:   
    NOTE: Picked up JDK_JAVA_OPTIONS:  --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED
    23-Feb-2022 13:25:57.568 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version name:   Apache Tomcat/9.0.56
    ...
    ```

    ```shell
    #连接面板2
    [root@iZ0jlettlgobqrxnscuoovZ ~]# docker ps
    CONTAINER ID   IMAGE                 COMMAND                  CREATED          STATUS          PORTS                                            NAMES
    3da1f6ac3f10   tomcat:9.0            "catalina.sh run"        46 seconds ago   Up 45 seconds   0.0.0.0:8080->8080/tcp                           funny_euclid
    [root@iZ0jlettlgobqrxnscuoovZ ~]# docker exec -it 3da1f6ac3f10 /bin/bash
    root@3da1f6ac3f10:/usr/local/tomcat# cp -r webapps.dist/* webapps
    root@3da1f6ac3f10:/usr/local/tomcat# cd webapps
    root@3da1f6ac3f10:/usr/local/tomcat/webapps# ls
    ROOT  docs  examples  host-manager  manager
    root@3da1f6ac3f10:/usr/local/tomcat/webapps# exit
    exit
    [root@iZ0jlettlgobqrxnscuoovZ ~]# docker ps
    CONTAINER ID   IMAGE                 COMMAND                  CREATED          STATUS          PORTS                                            NAMES
    3da1f6ac3f10   tomcat:9.0            "catalina.sh run"        13 minutes ago   Up 13 minutes   0.0.0.0:8080->8080/tcp                           funny_euclid
    [root@iZ0jlettlgobqrxnscuoovZ ~]# docker commit -m="add webapps app" -a="hzc" 3da1f6ac3f10 myTomcat:1.0
    invalid reference format: repository name must be lowercase
    [root@iZ0jlettlgobqrxnscuoovZ ~]# docker commit -m="add webapps app" -a="hzc" 3da1f6ac3f10 mytomcat:1.0
    sha256:1d58eb64a2a0f32f00db5d9efe0645efa6f21818455fd238dffb03ec3dcbc5d9
    [root@iZ0jlettlgobqrxnscuoovZ ~]# docker images
    REPOSITORY            TAG       IMAGE ID       CREATED              SIZE
    mytomcat              1.0       1d58eb64a2a0   About a minute ago   685MB
    nginx                 latest    605c77e624dd   7 weeks ago          141MB
    tomcat                9.0       b8e65a4d736d   2 months ago         680MB
    ```

- 我们如果向保存当前容器的状态，就可以通过commit来提交，获得一个镜像，就好比虚拟机的快照

- **到了这里才是才是入门Docker**

- **学习方式：先理解概念，然后实践，最后实践理论相结合**

